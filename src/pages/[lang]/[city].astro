---
/**
 * ═══════════════════════════════════════════════════════════
 * SERVICE AREA PAGES — LYRIX OS
 * Auto-generated city landing pages for local SEO
 * Route: /[lang]/[city]/ — e.g. /en/san-juan/, /es/dorado/
 * ═══════════════════════════════════════════════════════════
 */

import { getLangFromUrl } from '../../i18n/utils';
import type { Lang } from '../../i18n/ui';
import { CITIES } from '../../data/cities';
import Layout from '../../layouts/main.astro';
import Hero from '../../components/Hero.astro';
import Navigation from '../../components/Navigation';
import TrustedBy from '../../components/TrustedBy';
import Services from '../../components/sections/Services.astro';
import Portfolio from '../../components/sections/Portfolio.astro';
import Process from '../../components/sections/Process.astro';
import Reviews from '../../components/sections/Reviews.astro';
import FAQ from '../../components/sections/FAQ.astro';
import CTA from '../../components/sections/CTA.astro';
import CinematicTeaser from '../../components/CinematicTeaser';
import Pricing from '../../components/Pricing';

// ─── STATIC PATHS ───

export function getStaticPaths() {
  const paths: { params: { lang: string; city: string } }[] = [];
  for (const city of CITIES) {
    paths.push({ params: { lang: 'en', city: city.slug } });
    paths.push({ params: { lang: 'es', city: city.slug } });
  }
  return paths;
}

// ─── PAGE ───

const lang = getLangFromUrl(Astro.url) as Lang;
const { city: citySlug } = Astro.params;
const cityData = CITIES.find((c) => c.slug === citySlug)!;

const pageTitle = lang === 'es' ? cityData.titleEs : cityData.titleEn;
const pageDesc = lang === 'es' ? cityData.descriptionEs : cityData.descriptionEn;
const pageKeywords = lang === 'es' ? cityData.keywordsEs : cityData.keywordsEn;
---

<Layout lang={lang} title={pageTitle} description={pageDesc} keywords={pageKeywords}>
	<Navigation lang={lang} client:idle />
	<Hero lang={lang} />

	<main id="main-content">
		<TrustedBy lang={lang} client:visible />
		<Portfolio lang={lang} />
		<Services lang={lang} />
		<Reviews lang={lang} />
		<CinematicTeaser lang={lang} client:visible />
		<Process lang={lang} />
		<Pricing lang={lang} client:visible />
		<FAQ lang={lang} />
		<CTA lang={lang} />
	</main>
</Layout>
